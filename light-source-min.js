!function(t){t.fn.lightSource=function(i){var e=t.extend({blur:5,distanceBlur:!0,distanceBlurAmount:20,viewport:this,target:t("*",this),intensity:5,opacity:.8,offsetX:0,offsetY:0,lightWidth:700,lightHeight:700,lightOpacity:.1,lightBlur:40,lightColor:"#FFFFCC"},i),r=["drop-shadow(",e.offsetX,"px ",e.offsetY,"px ",e.blur,"px rgba(0,0,0,",e.opacity,"))"].join("");e.viewport.css({position:"relative",zIndex:100}),e.viewport.append('<div id="light"></div>');var o=t("#light");return o.css({position:"absolute",top:"50%",left:"50%",marginLeft:-(e.lightWidth/2),marginTop:-(e.lightHeight/2),opacity:e.lightOpacity,background:e.lightColor,filter:["blur(",e.lightBlur,"px)"].join(""),webkitFilter:["blur(",e.lightBlur,"px)"].join(""),mozFilter:["blur(",e.lightBlur,"px)"].join(""),width:e.lightWidth,height:e.lightHeight,borderRadius:e.viewport.width()/2+"px",zIndex:"1"}),e.target.css({filter:r,webkitFilter:r,mozFilter:r,position:"relative",zIndex:10}),e.viewport.mousemove(function(t){var i=t.pageX-e.viewport.offset().left,r=t.pageY-e.viewport.offset().top,l=e.viewport.width()/2,n=e.viewport.outerHeight()/2,h=(i-l)/e.intensity+e.offsetX,p=(r-n)/e.intensity+e.offsetY,g=h>0?h:-h,s=p>0?p:-p,a=(g+s)/4,u=1==e.distanceBlur?e.blur+a/e.distanceBlurAmount:e.blur,f=["drop-shadow(",-h,"px ",-p,"px ",u,"px rgba(0,0,0,",e.opacity,"))"].join(""),d=-(e.lightWidth/2)-h,c=-(e.lightHeight/2)-p;return o.css({marginTop:c,marginLeft:d}),e.target.css({filter:f,webkitFilter:f}),!1}),this}}(jQuery);
